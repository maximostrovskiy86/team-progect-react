(this["webpackJsonpteam-progect-react"]=this["webpackJsonpteam-progect-react"]||[]).push([[1],{19:function(e,a,t){e.exports={AuthNavigationBox:"AuthNavigation_AuthNavigationBox__qgGBG",authNav:"AuthNavigation_authNav__1tubr",activeNav:"AuthNavigation_activeNav__3Pxvj"}},20:function(e,a,t){e.exports={navLink:"Navigation_navLink__3TxyP"}},26:function(e,a,t){},3:function(e,a,t){"use strict";var r=t(11),n=t.n(r),c=t(17),s=t(13),u=t.n(s),l=t(12);u.a.defaults.baseURL="https://slimmom-backend.goit.global";var o=function(e){u.a.defaults.headers.common.Authorization="Bearer ".concat(e)},i=function(){u.a.defaults.headers.common.Authorization=""},d=Object(l.b)("auth/register",function(){var e=Object(c.a)(n.a.mark((function e(a,t){var r,c,s,l,i,d;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.username,c=a.email,s=a.password,l=t.rejectWithValue,e.prev=2,e.next=5,u.a.post("/auth/register",{username:r,email:c,password:s});case 5:return e.next=7,u.a.post("/auth/login",{email:c,password:s});case 7:return i=e.sent,d=i.data,o(d.accessToken),e.abrupt("return",d);case 13:return e.prev=13,e.t0=e.catch(2),e.abrupt("return",l(e.t0.message));case 16:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(a,t){return e.apply(this,arguments)}}()),j=Object(l.b)("auth/login",function(){var e=Object(c.a)(n.a.mark((function e(a,t){var r,c,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.rejectWithValue,e.prev=1,e.next=4,u.a.post("/auth/login",a);case 4:return c=e.sent,s=c.data,o(s.accessToken),e.abrupt("return",s);case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",r(e.t0.message));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(a,t){return e.apply(this,arguments)}}()),b=Object(l.b)("auth/logout",function(){var e=Object(c.a)(n.a.mark((function e(a,t){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.rejectWithValue,e.prev=1,e.next=4,u.a.post("/auth/logout",a);case 4:i(),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",r(e.t0.message));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(a,t){return e.apply(this,arguments)}}()),h=Object(l.b)("auth/refresh",function(){var e=Object(c.a)(n.a.mark((function e(a,t){var r,c,s,l,i,d,j;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.rejectWithValue,c=t.getState,s=c(),l=s.auth.refreshToken,i=s.auth.sid,null!==l){e.next=6;break}return e.abrupt("return",r());case 6:return o(l),e.prev=7,e.next=10,u.a.post("/auth/refresh",{sid:i});case 10:return d=e.sent,j=d.data,e.abrupt("return",j);case 15:return e.prev=15,e.t0=e.catch(7),e.abrupt("return",r(e.t0.message));case 18:case"end":return e.stop()}}),e,null,[[7,15]])})));return function(a,t){return e.apply(this,arguments)}}()),f=Object(l.b)("/user/refresh",function(){var e=Object(c.a)(n.a.mark((function e(a,t){var r,c,s,l,i,d;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.rejectWithValue,c=t.getState,s=c(),l=s.auth.accessToken,o(l),e.prev=4,e.next=7,u.a.get("/user");case 7:return i=e.sent,d=i.data,e.abrupt("return",d);case 12:return e.prev=12,e.t0=e.catch(4),e.abrupt("return",r(e.t0.message));case 15:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(a,t){return e.apply(this,arguments)}}()),p=Object(l.b)("/user/rateDaily",function(){var e=Object(c.a)(n.a.mark((function e(a,t){var r,c,s,l,i,d,j;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.rejectWithValue,c=t.getState,s=c(),console.log(s),console.log("LOG \u0441 ID"),l=s.user.id,i=s.auth.accessToken,o(i),e.prev=7,e.next=10,u.a.post("/daily-rate/".concat(l),a);case 10:return d=e.sent,j=d.data,console.log(a),e.abrupt("return",j);case 16:return e.prev=16,e.t0=e.catch(7),e.abrupt("return",r(e.t0.message));case 19:case"end":return e.stop()}}),e,null,[[7,16]])})));return function(a,t){return e.apply(this,arguments)}}()),g={register:d,logOut:b,logIn:j,refreshAccessToken:h,refreshUserData:f,rateDailyUser:p};a.a=g},32:function(e,a,t){e.exports={headerWrapper:"Header_headerWrapper__3c7PT",headerContainer:"Header_headerContainer__3ccm2"}},44:function(e,a,t){e.exports={Container:"Container_Container__1jnYA"}},50:function(e,a,t){},6:function(e,a,t){"use strict";t.d(a,"b",(function(){return r})),t.d(a,"a",(function(){return n.a}));var r={getIsLoggedIn:function(e){return e.user.isLoggedIn},getUserName:function(e){return e.user.username},getIsRefreshingUser:function(e){return e.auth.isRefreshingUser},getUserId:function(e){return e.user.id}},n=t(3)},81:function(e,a,t){"use strict";t.r(a);var r,n,c=t(0),s=t.n(c),u=t(22),l=t.n(u),o=(t(50),t(15)),i=t(5),d=t(42),j=t(12),b=t(14),h=t(4),f=t(3),p=t(29),g=t.n(p),O={key:"auth",storage:g.a},m={key:"user",storage:g.a},y=Object(j.c)({name:"user",initialState:{username:null,email:null,id:null,todaySummary:null,userData:null,isLoggedIn:!1,date:null,error:null},extraReducers:(r={},Object(h.a)(r,f.a.refreshUserData.fulfilled,(function(e,a){e.todaySummary=a.payload.days.daySummary,e.date=a.payload.days.date,e.userData=a.payload.userData,e.username=a.payload.username,e.email=a.payload.email,e.id=a.payload.id,e.isLoggedIn=!0})),Object(h.a)(r,f.a.refreshUserData.rejected,(function(e){e.username=null,e.email=null,e.id=null,e.todaySummary=null,e.userData=null,e.isLoggedIn=!1})),Object(h.a)(r,f.a.register.fulfilled,(function(e,a){e.date=a.payload.todaySummary.date,e.todaySummary=a.payload.todaySummary,e.userData=a.payload.user.userData,e.username=a.payload.user.username,e.email=a.payload.user.email,e.id=a.payload.user.id,e.isLoggedIn=!0})),Object(h.a)(r,f.a.logIn.fulfilled,(function(e,a){e.date=a.payload.todaySummary.date,e.todaySummary=a.payload.todaySummary,e.userData=a.payload.user.userData,e.username=a.payload.user.username,e.email=a.payload.user.email,e.id=a.payload.user.id,e.isLoggedIn=!0})),Object(h.a)(r,f.a.logOut.fulfilled,(function(e){e.username=null,e.email=null,e.id=null,e.todaySummary=null,e.userData=null,e.isLoggedIn=!1,e.date=null})),Object(h.a)(r,f.a.logOut.rejected,(function(e){e.username=null,e.email=null,e.id=null,e.todaySummary=null,e.userData=null,e.isLoggedIn=!1,e.date=null})),Object(h.a)(r,f.a.refreshAccessToken.rejected,(function(e){e.username=null,e.email=null,e.id=null,e.todaySummary=null,e.userData=null,e.isLoggedIn=!1,e.date=null})),Object(h.a)(r,f.a.refreshAccessToken.fulfilled,(function(e){e.isLoggedIn=!0})),Object(h.a)(r,f.a.rateDailyUser.fulfilled,(function(e,a){e.userData.dailyRate=a.payload.dailyRate,e.todaySummary=a.payload.summaries,e.userData.notAllowedProducts=a.payload.notAllowedProducts})),r)}),v=Object(j.c)({name:"auth",initialState:{accessToken:null,refreshToken:null,sid:null,error:null},extraReducers:(n={},Object(h.a)(n,f.a.register.pending,(function(e){e.error=null})),Object(h.a)(n,f.a.register.fulfilled,(function(e,a){e.accessToken=a.payload.accessToken,e.refreshToken=a.payload.refreshToken,e.sid=a.payload.sid})),Object(h.a)(n,f.a.register.rejected,(function(e,a){e.error=a.payload})),Object(h.a)(n,f.a.logIn.pending,(function(e){e.error=null})),Object(h.a)(n,f.a.logIn.fulfilled,(function(e,a){e.accessToken=a.payload.accessToken,e.refreshToken=a.payload.refreshToken,e.sid=a.payload.sid})),Object(h.a)(n,f.a.logIn.rejected,(function(e,a){e.error=a.payload})),Object(h.a)(n,f.a.logOut.pending,(function(e){e.error=null})),Object(h.a)(n,f.a.logOut.fulfilled,(function(e){e.accessToken=null,e.refreshToken=null,e.sid=null})),Object(h.a)(n,f.a.logOut.rejected,(function(e,a){e.accessToken=null,e.refreshToken=null,e.sid=null,e.error=a.payload})),Object(h.a)(n,f.a.refreshAccessToken.pending,(function(e){e.error=null})),Object(h.a)(n,f.a.refreshAccessToken.fulfilled,(function(e,a){e.accessToken=a.payload.accessToken,e.refreshToken=a.payload.refreshToken,e.sid=a.payload.sid,e.isRefreshingToken=!1})),Object(h.a)(n,f.a.refreshAccessToken.rejected,(function(e,a){e.accessToken=null,e.refreshToken=null,e.sid=null,e.error=a.payload})),n)}),x=Object(b.g)(m,y.reducer),k=Object(b.g)(O,v.reducer),T=Object(j.a)({reducer:{user:x,auth:k},middleware:function(e){return e({serializableCheck:{ignoredActions:[b.a,b.f,b.b,b.c,b.d,b.e]}})},devTools:!1}),N=Object(b.h)(T),I=t(6),L=t(16),D=t(25),S=t(2),_=t(1),w=["children","restricted","redirectTo"];function A(e){var a=e.children,t=e.restricted,r=void 0!==t&&t,n=e.redirectTo,c=void 0===n?"/":n,s=Object(D.a)(e,w),u=Object(i.c)(I.b.getIsLoggedIn)&&r;return Object(_.jsx)(S.b,Object(L.a)(Object(L.a)({},s),{},{children:u?Object(_.jsx)(S.a,{to:c}):a}))}var C=["children","redirectTo"];function U(e){var a=e.children,t=e.redirectTo,r=void 0===t?"/":t,n=Object(D.a)(e,C),c=Object(i.c)(I.b.getIsLoggedIn);return Object(_.jsx)(S.b,Object(L.a)(Object(L.a)({},n),{},{children:c?a:Object(_.jsx)(S.a,{to:r})}))}var W=t(19),R=t.n(W),z=function(){return Object(_.jsxs)("div",{className:R.a.AuthNavigationBox,children:[Object(_.jsx)(o.c,{className:R.a.authNav,activeClassName:R.a.activeNav,to:"/login",exact:!0,children:"\u0412\u0445\u043e\u0434"}),Object(_.jsx)(o.c,{className:R.a.authNav,activeClassName:R.a.activeNav,to:"/register",exact:!0,children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})]})},B=t(20),P=t.n(B),V=function(){var e=Object(i.c)(I.b.getIsLoggedIn);return Object(_.jsx)("nav",{className:P.a.nav,children:e&&Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(o.c,{className:P.a.navLink,activeClassName:P.a.activeNav,to:"/diary",exact:!0,children:"\u0414\u043d\u0435\u0432\u043d\u0438\u043a"}),Object(_.jsx)(o.c,{className:P.a.navLink,activeClassName:P.a.activeNav,to:"/calculator",exact:!0,children:"\u041a\u0430\u043b\u044c\u043a\u0443\u043b\u044f\u0442\u043e\u0440"})]})})},G=t(26),E=t.n(G),H=function(){var e=Object(i.b)(),a=Object(i.c)(I.b.getUserName);return Object(_.jsxs)("div",{className:E.a.userWrapper,children:[Object(_.jsx)("span",{className:E.a.userName,children:a}),Object(_.jsx)("button",{className:E.a.logBtn,type:"button",onClick:function(){e(I.a.logOut())},children:"logout"})]})},J=t(32),q=t.n(J);function F(){var e=Object(i.c)(I.b.getIsLoggedIn);return Object(_.jsx)("header",{className:q.a.headerWrapper,children:Object(_.jsxs)("div",{className:q.a.headerContainer,children:[Object(_.jsx)(V,{})," ",e?Object(_.jsx)(H,{}):Object(_.jsx)(z,{})]})})}var M=t(44),Y=t.n(M),K=function(e){var a=e.children;return Object(_.jsx)("div",{className:Y.a.Container,children:a})},Q=Object(c.lazy)((function(){return Promise.all([t.e(0),t.e(9),t.e(5)]).then(t.bind(null,254))})),X=Object(c.lazy)((function(){return t.e(8).then(t.bind(null,255))})),Z=Object(c.lazy)((function(){return t.e(7).then(t.bind(null,256))})),$=Object(c.lazy)((function(){return t.e(6).then(t.bind(null,252))})),ee=Object(c.lazy)((function(){return Promise.all([t.e(0),t.e(4)]).then(t.bind(null,253))}));function ae(){var e=Object(i.b)(),a=Object(i.c)(I.b.getIsRefreshingUser),t=Object(i.c)(I.b.getIsLoggedIn);return Object(c.useEffect)((function(){t&&e(I.a.refreshUserData())}),[e]),!a&&Object(_.jsxs)(K,{children:[Object(_.jsx)(F,{}),Object(_.jsx)(S.d,{children:Object(_.jsxs)(c.Suspense,{fallback:Object(_.jsx)("div",{children:"loader"}),children:[Object(_.jsx)(A,{exact:!0,path:"/",children:Object(_.jsx)(Q,{})}),Object(_.jsx)(A,{path:"/register",restricted:!0,children:Object(_.jsx)(X,{})}),Object(_.jsx)(A,{path:"/login",restricted:!0,redirectTo:"/diary",children:Object(_.jsx)(Z,{})}),Object(_.jsx)(U,{path:"/diary",restricted:!0,redirectTo:"/login",children:Object(_.jsx)($,{})}),Object(_.jsx)(U,{path:"/calculator",restricted:!0,redirectTo:"/login",children:Object(_.jsx)(ee,{})}),Object(_.jsx)(S.a,{to:"/"})]})})]})}l.a.render(Object(_.jsx)(s.a.StrictMode,{children:Object(_.jsx)(i.a,{store:T,children:Object(_.jsx)(d.a,{loading:Object(_.jsx)("h2",{children:"...loading"}),persistor:N,children:Object(_.jsx)(o.a,{children:Object(_.jsx)(ae,{})})})})}),document.getElementById("root"))}},[[81,2,3]]]);
//# sourceMappingURL=main.90e11272.chunk.js.map